#!/bin/bash

# Set the system-wide monospace font for kitty, hyprlock, waybar, etc.
# The font name must be one of the ones returned by dots-font-list.

DOTS="$HOME/.dots"
font_name="$1"

if [[ -n $font_name ]]; then
  if fc-list | grep -iq "$font_name"; then
    if [[ -f "$DOTS/.config/kitty/kitty.conf" ]]; then
      sed -i "s/^font_family .*/font_family $font_name/g" "$DOTS/.config/kitty/kitty.conf"
      pkill -USR1 kitty 2>/dev/null
    fi

    if [[ -f "$DOTS/.config/hypr/hyprlock.conf" ]]; then
      sed -i "s/font_family = .*/font_family = $font_name/g" "$DOTS/.config/hypr/hyprlock.conf"
    fi

    if [[ -f "$DOTS/.config/waybar/style.css" ]]; then
      sed -i "s/font-family: .*/font-family: '$font_name';/g" "$DOTS/.config/waybar/style.css"
    fi

    if command -v waybar &>/dev/null; then
      waybarctl reload 2>/dev/null || pkill -HUP waybar
    fi

    echo "Font set to: $font_name"
  else
    echo "Font '$font_name' not found."
    exit 1
  fi
else
  echo "Usage: dots-font-set <font-name>"
fi
